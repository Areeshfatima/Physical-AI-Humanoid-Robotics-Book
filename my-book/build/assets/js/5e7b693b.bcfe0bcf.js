"use strict";(globalThis.webpackChunkmy_book=globalThis.webpackChunkmy_book||[]).push([[554],{3023(e,n,i){i.d(n,{R:()=>l,x:()=>t});var s=i(3696);const r={},o=s.createContext(r);function l(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(o.Provider,{value:n},e.children)}},6414(e,n,i){i.d(n,{A:()=>s});const s="data:image/png;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjBmMGYwIi8+CiAgPHJlY3QgeD0iMTAiIHk9IjEwIiB3aWR0aD0iMzgwIiBoZWlnaHQ9IjE4MCIgZmlsbD0iI2QzZDNkMyIgc3Ryb2tlPSIjYTlhOWE5IiBzdHJva2Utd2lkdGg9IjIiLz4KICA8dGV4dCB4PSIyMDAiIHk9IjkwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiMwMDAwMDAiPltJTUFHRSBQTEFDRUhPTERFUl08L3RleHQ+CiAgPHRleHQgeD0iMjAwIiB5PSIxMTUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxMiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iIzAwMDAwMCI+TWlzc2luZyBpbWFnZSB3aWxsIGFwcGVhciBoZXJlPC90ZXh0PgogIDx0ZXh0IHg9IjIwMCIgeT0iMTM1IiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTIiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiMwMDAwMDAiPndoZW4gYXZhaWxhYmxlPC90ZXh0PgogIDxwYXRoIGQ9Ik01MCw1MCBMMzUwLDUwIEwzNTAsMTUwIEw1MCwxNTAgWiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjYTlhOWE5IiBzdHJva2Utd2lkdGg9IjEiLz4KICA8cGF0aCBkPSJNNTAsNTAgTDM1MCwxNTAgTTM1MCw1MCBMNTAsMTUwIiBzdHJva2U9IiNhOWE5YTkiIHN0cm9rZS13aWR0aD0iMSIvPgo8L3N2Zz4="},9949(e,n,i){i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>m,frontMatter:()=>l,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"module-1-ros2/chapter-2","title":"ROS2 Nodes and Topics","description":"Mastering fundamental communication patterns with ROS2 nodes and topics","source":"@site/docs/module-1-ros2/chapter-2.md","sourceDirName":"module-1-ros2","slug":"/module-1-ros2/chapter-2","permalink":"/Physical-AI-Humanoid-Robotics-Book/docs/module-1-ros2/chapter-2","draft":false,"unlisted":false,"editUrl":"undefined/docs/module-1-ros2/chapter-2.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"ROS2 Nodes and Topics","sidebar_position":3,"description":"Mastering fundamental communication patterns with ROS2 nodes and topics","keywords":["ROS2","nodes","topics","publishers","subscribers","communication"],"id":"chapter-2"},"sidebar":"textbookSidebar","previous":{"title":"ROS2 Overview and Architecture","permalink":"/Physical-AI-Humanoid-Robotics-Book/docs/module-1-ros2/chapter-1"},"next":{"title":"ROS2 Services and Actions","permalink":"/Physical-AI-Humanoid-Robotics-Book/docs/module-1-ros2/chapter-3"}}');var r=i(2540),o=i(3023);const l={title:"ROS2 Nodes and Topics",sidebar_position:3,description:"Mastering fundamental communication patterns with ROS2 nodes and topics",keywords:["ROS2","nodes","topics","publishers","subscribers","communication"],id:"chapter-2"},t="ROS2 Nodes and Topics",a={},c=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Introduction to Nodes",id:"introduction-to-nodes",level:2},{value:"Node Concepts and Implementation",id:"node-concepts-and-implementation",level:2},{value:"Creating a Basic Node",id:"creating-a-basic-node",level:3},{value:"Node Lifecycle",id:"node-lifecycle",level:3},{value:"Topics and Publishing/Subscription",id:"topics-and-publishingsubscription",level:2},{value:"Topic Communication",id:"topic-communication",level:3},{value:"Message Types",id:"message-types",level:3},{value:"Quality of Service (QoS) in Topics",id:"quality-of-service-qos-in-topics",level:3},{value:"Advanced Node Concepts",id:"advanced-node-concepts",level:2},{value:"Parameters",id:"parameters",level:3},{value:"Names and Namespaces",id:"names-and-namespaces",level:3},{value:"Practical Example: Turtle Simulator",id:"practical-example-turtle-simulator",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Node Design",id:"node-design",level:3},{value:"Topic Communication",id:"topic-communication-1",level:3},{value:"Summary",id:"summary",level:2},{value:"Exercises",id:"exercises",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"ros2-nodes-and-topics",children:"ROS2 Nodes and Topics"})}),"\n",(0,r.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,r.jsx)(n.p,{children:"After completing this chapter, you should be able to:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Create and implement ROS2 nodes in both C++ and Python"}),"\n",(0,r.jsx)(n.li,{children:"Design publisher-subscriber communication patterns"}),"\n",(0,r.jsx)(n.li,{children:"Configure Quality of Service (QoS) settings appropriately"}),"\n",(0,r.jsx)(n.li,{children:"Apply best practices for node design and resource management"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"introduction-to-nodes",children:"Introduction to Nodes"}),"\n",(0,r.jsxs)(n.p,{children:["In ROS2, a ",(0,r.jsx)(n.strong,{children:"node"})," is a process that performs computation. Nodes are the fundamental building blocks of a ROS2 system. Each node is typically responsible for a specific task in the robot's operation, such as sensor data processing, motion control, or decision making."]}),"\n",(0,r.jsx)(n.h2,{id:"node-concepts-and-implementation",children:"Node Concepts and Implementation"}),"\n",(0,r.jsx)(n.h3,{id:"creating-a-basic-node",children:"Creating a Basic Node"}),"\n",(0,r.jsx)(n.p,{children:"A minimal ROS2 node can be implemented in either C++ or Python. Here's an example in Python:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\n\nclass MinimalPublisher(Node):\n\n    def __init__(self):\n        super().__init__('minimal_publisher')\n        self.publisher_ = self.create_publisher(String, 'topic', 10)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = 'Hello World: %d' % self.i\n        self.publisher_.publish(msg)\n        self.get_logger().info('Publishing: \"%s\"' % msg.data)\n        self.i += 1\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_publisher = MinimalPublisher()\n    rclpy.spin(minimal_publisher)\n    minimal_publisher.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.p,{children:"To run this publisher:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Make sure your ROS2 environment is sourced: ",(0,r.jsx)(n.code,{children:"source /opt/ros/humble/setup.bash"})]}),"\n",(0,r.jsxs)(n.li,{children:["Create a new package: ",(0,r.jsx)(n.code,{children:"ros2 pkg create --build-type ament_python minimal_publisher"})]}),"\n",(0,r.jsxs)(n.li,{children:["Place this code in ",(0,r.jsx)(n.code,{children:"minimal_publisher/minimal_publisher/publisher_member_function.py"})]}),"\n",(0,r.jsxs)(n.li,{children:["Run: ",(0,r.jsx)(n.code,{children:"ros2 run minimal_publisher publisher_member_function"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"node-lifecycle",children:"Node Lifecycle"}),"\n",(0,r.jsx)(n.p,{children:"ROS2 nodes have a more sophisticated lifecycle compared to ROS1:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Unconfigured"}),": Initial state"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Inactive"}),": Configured but not active"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Active"}),": Running and participating in communications"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Finalized"}),": Shutdown state"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This allows for better coordination of system startup and shutdown."}),"\n",(0,r.jsx)(n.h2,{id:"topics-and-publishingsubscription",children:"Topics and Publishing/Subscription"}),"\n",(0,r.jsx)(n.h3,{id:"topic-communication",children:"Topic Communication"}),"\n",(0,r.jsxs)(n.p,{children:["Topics in ROS2 enable ",(0,r.jsx)(n.strong,{children:"publisher-subscriber"})," communication patterns. This is a one-to-many relationship where:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Publishers"})," send messages to a topic"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Subscribers"})," receive messages from a topic"]}),"\n",(0,r.jsx)(n.li,{children:"Multiple publishers and subscribers can exist for the same topic"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{alt:"ROS2 Topic Communication Diagram",src:i(6414).A+"",width:"400",height:"200"}),"\n",(0,r.jsx)(n.em,{children:"Figure 2.1: ROS2 topic communication showing the publisher-subscriber pattern"})]}),"\n",(0,r.jsx)(n.h3,{id:"message-types",children:"Message Types"}),"\n",(0,r.jsxs)(n.p,{children:["Messages are defined in ",(0,r.jsx)(n.code,{children:".msg"})," files and must be compatible between publishers and subscribers. Common message types include:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"std_msgs"}),": Basic data types (String, Int32, Float64, etc.)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"sensor_msgs"}),": Sensor data (Image, LaserScan, etc.)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"geometry_msgs"}),": Spatial relationships (Point, Pose, Twist, etc.)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"nav_msgs"}),": Navigation-specific messages (Odometry, Path, etc.)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"quality-of-service-qos-in-topics",children:"Quality of Service (QoS) in Topics"}),"\n",(0,r.jsx)(n.p,{children:"QoS profiles allow fine-tuning of communication behavior:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, QoSReliabilityPolicy, QoSHistoryPolicy\n\n# Configure a QoS profile for sensor data (best effort, keep last 10)\nqos_profile = QoSProfile(\n    reliability=QoSReliabilityPolicy.BEST_EFFORT,\n    history=QoSHistoryPolicy.KEEP_LAST,\n    depth=10\n)\n\npublisher = node.create_publisher(LaserScan, 'sensor_scan', qos_profile)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"advanced-node-concepts",children:"Advanced Node Concepts"}),"\n",(0,r.jsx)(n.h3,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsx)(n.p,{children:"Nodes can accept parameters that can be configured at runtime:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class ParameterNode(Node):\n\n    def __init__(self):\n        super().__init__('parameter_node')\n        self.declare_parameter('my_parameter', 'default_value')\n        \n    def get_parameter_value(self):\n        return self.get_parameter('my_parameter').value\n"})}),"\n",(0,r.jsx)(n.p,{children:"Parameters offer flexibility in configuring node behavior without recompilation."}),"\n",(0,r.jsx)(n.h3,{id:"names-and-namespaces",children:"Names and Namespaces"}),"\n",(0,r.jsx)(n.p,{children:"Nodes, topics, and services use a hierarchical naming system:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Names"}),": Simple identifiers (e.g., ",(0,r.jsx)(n.code,{children:"/cmd_vel"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Namespaces"}),": Grouping mechanism (e.g., ",(0,r.jsx)(n.code,{children:"/robot1/cmd_vel"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Private Names"}),": Node-specific names (e.g., ",(0,r.jsx)(n.code,{children:"~parameter_name"}),")"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"practical-example-turtle-simulator",children:"Practical Example: Turtle Simulator"}),"\n",(0,r.jsx)(n.p,{children:"Let's consider a practical example with the turtle simulator:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom geometry_msgs.msg import Twist\nfrom turtlesim.msg import Pose\n\nclass TurtleController(Node):\n\n    def __init__(self):\n        super().__init__('turtle_controller')\n        \n        # Publisher for velocity commands\n        self.cmd_vel_publisher = self.create_publisher(\n            Twist, \n            '/turtle1/cmd_vel', \n            10\n        )\n        \n        # Subscriber for pose information\n        self.pose_subscriber = self.create_subscription(\n            Pose,\n            '/turtle1/pose',\n            self.pose_callback,\n            10\n        )\n        \n        # Timer for control loop\n        self.timer = self.create_timer(0.1, self.control_loop)\n        \n    def pose_callback(self, msg):\n        self.current_pose = msg\n        \n    def control_loop(self):\n        # Implement control logic here\n        cmd_msg = Twist()\n        cmd_msg.linear.x = 1.0  # Move forward\n        cmd_msg.angular.z = 0.5  # Turn slightly\n        self.cmd_vel_publisher.publish(cmd_msg)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    controller = TurtleController()\n    rclpy.spin(controller)\n    controller.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"node-design",children:"Node Design"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Single Responsibility"}),": Each node should have a clear, single purpose"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Efficient Resource Usage"}),": Properly manage memory and CPU resources"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Error Handling"}),": Implement robust error handling and recovery mechanisms"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameter Configuration"}),": Use parameters for configurable behavior"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"topic-communication-1",children:"Topic Communication"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Appropriate QoS"}),": Choose QoS settings based on data requirements"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Message Optimization"}),": Design efficient message structures"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Rate Limiting"}),": Publish at appropriate rates to avoid overwhelming subscribers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Topic Naming Conventions"}),": Use descriptive and consistent naming"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsxs)(n.p,{children:["Nodes and topics form the foundation of ROS2 communication. Understanding how to properly design nodes and utilize topic-based communication patterns is essential for developing robust robotic applications. The next chapter will explore more advanced communication patterns with ",(0,r.jsx)(n.a,{href:"/Physical-AI-Humanoid-Robotics-Book/docs/module-1-ros2/chapter-3",children:"services and actions"}),", which provide request-response and goal-oriented interaction models."]}),"\n",(0,r.jsx)(n.h2,{id:"exercises",children:"Exercises"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Create a simple ROS2 publisher that publishes sensor data (e.g., temperature readings) at 1Hz."}),"\n",(0,r.jsx)(n.li,{children:"Implement a subscriber that listens to the publisher from exercise 1 and logs the data to a file."}),"\n",(0,r.jsx)(n.li,{children:"Experiment with different QoS settings (reliability, durability) and observe how they affect communication."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"/Physical-AI-Humanoid-Robotics-Book/docs/module-1-ros2/chapter-3",children:"Next: ROS2 Services and Actions"})," | ",(0,r.jsx)(n.a,{href:"/Physical-AI-Humanoid-Robotics-Book/docs/module-1-ros2/chapter-1",children:"Previous: ROS2 Overview and Architecture"})]})]})}function m(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);